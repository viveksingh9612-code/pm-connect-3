<!-- Header Section -->
<div class="mx-auto mb-6 flex items-center justify-between px-6 py-3 bg-gradient-to-r from-blue-500 to-red-500 shadow-md">
  <button class="text-white hover:text-gray-200" (click)="goBack()">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
    </svg>
  </button>
  <img src="assets/logo/logo.png" alt="Logo" class="h-8 w-auto">
</div>

<div class="max-w-6xl mx-auto mt-10 p-6 bg-white shadow-lg rounded-2xl">
  <h2 class="text-3xl font-extrabold text-gray-900 mb-6">All Drivers</h2>

  <div class="overflow-x-auto">
    <table class="min-w-full border-collapse text-sm">
      <thead>
        <tr class="bg-gradient-to-r from-purple-500 to-pink-500 text-white uppercase text-xs tracking-wider">
          <th class="px-4 py-3 text-left rounded-tl-lg">#</th>
          <th class="px-4 py-3 text-left">Driver Name</th>
          <th class="px-4 py-3 text-left">Driver Number</th>
          <th class="px-4 py-3 text-left">Cab Number</th>
          <th class="px-4 py-3 text-left">Starting Place</th>
          <th class="px-4 py-3 text-left">Middle Stoppage</th>
          <th class="px-4 py-3 text-left">Ending Location</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-200">
        <tr *ngFor="let driver of paginatedDrivers; let i = index"
            class="hover:bg-gray-50 transition duration-200 cursor-pointer"
            (click)="openModal(driver)">
          <td class="px-4 py-3 font-medium text-gray-700">
            {{ (currentPage - 1) * itemsPerPage + i + 1 }}
          </td>
          <td class="px-4 py-3 text-gray-800">{{ driver.driverName }}</td>
          <td class="px-4 py-3 text-gray-600">{{ driver.driverNumber }}</td>
          <td class="px-4 py-3 text-gray-700 font-semibold">{{ driver.cabNumber }}</td>
          <td class="px-4 py-3 text-gray-700">{{ driver.startingPoint }}</td>
          <td class="px-4 py-3 text-gray-500">{{ driver.middleStoppagePoints }}</td>
          <td class="px-4 py-3 text-gray-700">{{ driver.stoppingPoint }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div class="mt-4 flex justify-end items-center space-x-2">
    <button (click)="prevPage()" [disabled]="currentPage === 1"
      class="px-3 py-1 bg-gray-200 rounded-md hover:bg-gray-300 transition disabled:opacity-50">
      Previous
    </button>

    <button *ngFor="let page of [].constructor(totalPages); let idx = index"
      (click)="goToPage(idx + 1)"
      [class.bg-purple-500]="currentPage === idx + 1"
      [class.text-white]="currentPage === idx + 1"
      class="px-3 py-1 rounded-md hover:bg-purple-600 transition"
      [ngClass]="{ 'bg-gray-200': currentPage !== idx + 1 }">
      {{ idx + 1 }}
    </button>

    <button (click)="nextPage()" [disabled]="currentPage === totalPages"
      class="px-3 py-1 bg-gray-200 rounded-md hover:bg-gray-300 transition disabled:opacity-50">
      Next
    </button>
  </div>
</div>

<div *ngIf="showModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white w-full max-w-3xl rounded-lg shadow-lg p-6 relative">
    <!-- Close Button -->
    <button (click)="closeModal()" class="absolute top-3 right-3 text-gray-500 hover:text-gray-800">
      âœ–
    </button>

    <!-- Cab Info -->
    <h3 class="text-2xl font-bold mb-4 text-gray-800">Cab Details</h3>
    <div class="grid grid-cols-2 gap-4 mb-6">
      <p><strong>Driver:</strong> {{ selectedDriver?.driverName }}</p>
      <p><strong>Number:</strong> {{ selectedDriver?.driverNumber }}</p>
      <p><strong>Cab Number:</strong> {{ selectedDriver?.cabNumber }}</p>
      <p><strong>Starting Point:</strong> {{ selectedDriver?.startingPoint }}</p>
      <p><strong>Middle Stops:</strong> {{ selectedDriver?.middleStoppagePoints }}</p>
      <p><strong>Ending Point:</strong> {{ selectedDriver?.stoppingPoint }}</p>
    </div>

    <!-- Users Table -->
    <h4 class="text-xl font-semibold mb-3 text-gray-700">Assigned Users</h4>
    <div class="overflow-x-auto">
      <table class="min-w-full border-collapse text-sm">
        <thead>
          <tr class="bg-gray-100 text-gray-600 uppercase text-xs">
            <th class="px-4 py-2 text-left">Employee ID</th>
            <th class="px-4 py-2 text-left">Name</th>
            <th class="px-4 py-2 text-left">Email</th>
            <th class="px-4 py-2 text-left">Phone</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let u of selectedDriver?.users" class="border-t">
            <td class="px-4 py-2">{{ u.username }}</td>
            <td class="px-4 py-2">{{ u.firstName }} {{ u.middleName }} {{ u.lastName }}</td>
            <td class="px-4 py-2">{{ u.email }}</td>
            <td class="px-4 py-2">{{ u.phoneNumber }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>